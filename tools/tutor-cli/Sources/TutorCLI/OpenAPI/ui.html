<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tutor Serve API — Custom Viewer</title>
    <style>
      :root { --bg: #0d1117; --fg: #c9d1d9; --muted: #8b949e; --accent: #58a6ff; --panel: #161b22; }
      body { margin: 0; background: var(--bg); color: var(--fg); font: 14px/1.4 -apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }
      header { padding: 12px 16px; border-bottom: 1px solid #30363d; position: sticky; top: 0; background: var(--panel); z-index: 5; }
      h1 { font-size: 18px; margin: 0; }
      #wrap { display: grid; grid-template-columns: 320px 1fr; height: calc(100vh - 48px); }
      #sidebar { border-right: 1px solid #30363d; overflow: auto; background: var(--panel); }
      #content { overflow: auto; padding: 16px; }
      .path { padding: 8px 12px; cursor: pointer; border-bottom: 1px solid #21262d; }
      .path:hover { background: #1f2630; }
      .method { display:inline-block; min-width: 48px; text-transform: uppercase; font-size: 11px; padding: 2px 6px; border-radius: 4px; background:#30363d; color:#d1d5da; margin-right:8px }
      pre { background: #0b0f14; border: 1px solid #30363d; border-radius: 8px; padding: 12px; overflow: auto; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 12px; }
      .muted { color: var(--muted); }
    </style>
    <script src="/assets/js-yaml.min.js"></script>
  </head>
  <body>
    <header><h1>Tutor Serve API — Custom Viewer</h1></header>
    <div id="wrap">
      <div id="sidebar"></div>
      <div id="content"><p class="muted">Select a path to view details. Spec: <a href="/openapi.yaml">/openapi.yaml</a></p></div>
    </div>
    <script>
      async function loadSpec() {
        const res = await fetch('/openapi.yaml');
        const text = await res.text();
        const spec = jsyaml.load(text);
        const sidebar = document.getElementById('sidebar');
        const content = document.getElementById('content');
        const paths = spec.paths || {};
        const entries = Object.entries(paths).sort((a,b)=>a[0].localeCompare(b[0]));
        sidebar.innerHTML = '';
        for (const [p, ops] of entries) {
          const div = document.createElement('div'); div.className = 'path';
          const firstMethod = Object.keys(ops)[0] || 'get';
          const method = document.createElement('span'); method.className='method'; method.textContent = firstMethod;
          const name = document.createElement('span'); name.textContent = p;
          div.appendChild(method); div.appendChild(name);
          div.onclick = () => {
            const pretty = JSON.stringify(ops, null, 2);
            content.innerHTML = `<h2><span class="method">${firstMethod}</span> ${p}</h2><pre><code>${pretty.replace(/</g,'&lt;')}</code></pre>`;
          };
          sidebar.appendChild(div);
        }
        if (entries.length > 0) sidebar.firstChild.click();
      }
      loadSpec().catch(e=>{
        document.getElementById('content').innerHTML = `<p style="color:#ff7b72">Failed to load spec: ${e}</p>`;
      });
    </script>
  </body>
  </html>

